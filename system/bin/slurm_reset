#!/bin/bash

# slurm_reset
# Matt Allbright
# Simple utility to reset slurm nodes on network.

echo "Restarting all daemons."

echo "Restarting hope"
ssh scanlab@hope /etc/init.d/munge restart
wait
ssh scanlab@hope /usr/sbin/slurmctld restart
wait
ssh scanlab@hope systemctl restart slurmd.service
wait
#ssh scanlab@hope /usr/sbin/slurmdbd restart
#wait
echo "Restarting empire"
ssh scanlab@empire /etc/init.d/munge restart
wait
ssh scanlab@empire /usr/sbin/slurmctld restart
wait
ssh scanlab@empire systemctl restart slurmd.service
wait
echo "Restarting jedi"
ssh scanlab@jedi /etc/init.d/munge restart
wait
ssh scanlab@jedi systemctl restart slurmd.service
wait
echo "Restarting hyperion"
ssh scanlab@hyperion /etc/init.d/munge restart
wait
ssh scanlab@hyperion systemctl restart slurmd.service
wait
echo "Restarting norman"
ssh scanlab@norman /etc/init.d/munge restart
wait
ssh scanlab@norman systemctl restart slurmd.service
wait
echo "Restarting wilbur"
ssh scanlab@wilbur /etc/init.d/munge restart
wait
ssh scanlab@wilbur systemctl restart slurmd.service
wait
echo "Restarting rufus"
ssh scanlab@rufus /etc/init.d/munge restart
wait
ssh scanlab@rufus systemctl restart slurmd.service
wait
